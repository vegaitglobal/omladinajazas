(function(a){var k={panels:[],panelCounter:0,postsData:{},allowPanelImageResize:!0,init:function(){"single"===as_js_vars.page?this.initSingleAccordionPage():"all"===as_js_vars.page&&this.initAllAccordionsPage()},initSingleAccordionPage:function(){var b=this;this.initPanels();-1!==parseInt(as_js_vars.id,10)&&this.loadAccordionData(function(){b.checkBackgroundImageSize()});a("form").on("submit",function(a){a.preventDefault();b.saveAccordion();b.checkBackgroundImageSize()});a(".preview-accordion").on("click",
function(a){a.preventDefault();b.previewAccordion()});a(".add-panel").on("click",function(a){a.preventDefault();b.addImagePanels()});a(".postbox .hndle, .postbox .handlediv").on("click",function(){var c=a(this).parent(".postbox");!0===c.hasClass("closed")?c.removeClass("closed"):c.addClass("closed")});a(".sidebar-settings").on("mouseover","label",function(){b.showInfo(a(this))});a(window).resize(function(){!0===b.allowPanelImageResize&&(b.resizePanelImages(),b.allowPanelImageResize=!1,setTimeout(function(){b.resizePanelImages();
b.allowPanelImageResize=!0},250))})},initAllAccordionsPage:function(){var b=this;a(".accordions-list").on("click",".preview-accordion",function(c){c.preventDefault();b.previewAccordionAll(a(this))});a(".accordions-list").on("click",".delete-accordion",function(c){c.preventDefault();b.deleteAccordion(a(this))});a(".accordions-list").on("click",".duplicate-accordion",function(c){c.preventDefault();b.duplicateAccordion(a(this))});a(".clear-all-cache").on("click",function(c){c.preventDefault();a(".clear-cache-spinner").css({display:"inline-block",
visibility:"visible"});c=a(this).attr("data-nonce");a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_clear_all_cache",nonce:c},complete:function(c){a(".clear-cache-spinner").css({display:"",visibility:""})}})})},loadAccordionData:function(b){var c=this;a(".panel-spinner").css({display:"inline-block",visibility:"visible"});a.ajax({url:as_js_vars.ajaxurl,type:"get",data:{action:"accordion_slider_lite_get_accordion_data",id:as_js_vars.id,nonce:as_js_vars.lad_nonce},complete:function(e){e=
a.parseJSON(e.responseText);a.each(e.panels,function(b,e){var f={background:{},layers:e.layers,html:e.html,settings:a.isArray(e.settings)?{}:e.settings};a.each(e,function(a,c){-1!==a.indexOf("background")&&(f.background[a]=c)});c.getPanel(b).setData("all",f)});a(".panel-spinner").css({display:"",visibility:""});b()}})},saveAccordion:function(){var b=this.getAccordionData();b.nonce=as_js_vars.sa_nonce;b.action="save";b=JSON.stringify(b);var c=a(".update-spinner").css({display:"inline-block",visibility:"visible"});
a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_save_accordion",data:b},complete:function(b){c.css({display:"",visibility:""});-1===parseInt(as_js_vars.id,10)&&!1===isNaN(b.responseText)?(a("h2").after('<div class="updated"><p>'+as_js_vars.accordion_create+"</p></div>"),window.location=as_js_vars.admin+"?page=accordion-slider-lite&id="+b.responseText+"&action=edit"):0===a(".updated").length&&a("h2").after('<div class="updated"><p>'+as_js_vars.accordion_update+"</p></div>")}})},
getAccordionData:function(){var b=this,c={id:as_js_vars.id,name:a("input#title").val(),settings:{},panels:[],panels_state:{}};a(".panels-container").find(".panel").each(function(e){var f=a(this),l=b.getPanel(parseInt(f.attr("data-id"),10)).getData("all");l.position=parseInt(f.attr("data-position"),10);c.panels[e]=l});a(".sidebar-settings").find(".setting").each(function(){var b=a(this);c.settings[b.attr("name")]="checkbox"===b.attr("type")?b.is(":checked"):b.val()});a(".sidebar-settings").find(".postbox").each(function(){var b=
a(this);c.panels_state[b.attr("data-name")]=b.hasClass("closed")?"closed":""});return c},previewAccordion:function(){g.open(this.getAccordionData())},previewAccordionAll:function(b){var c=a.lightURLParse(b.attr("href"));b=c.lad_nonce;c=parseInt(c.id,10);a.ajax({url:as_js_vars.ajaxurl,type:"get",data:{action:"accordion_slider_lite_get_accordion_data",id:c,nonce:b},complete:function(b){b=a.parseJSON(b.responseText);g.open(b)}})},deleteAccordion:function(b){var c=a.lightURLParse(b.attr("href")),e=c.da_nonce,
f=parseInt(c.id,10),l=b.parents("tr"),d=a('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-accordion-dialog">\t\t<p class="dialog-question">'+as_js_vars.accordion_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+as_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+as_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");a(".modal-window-container").css("top",a(window).scrollTop());
d.find(".dialog-ok").one("click",function(b){b.preventDefault();a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_delete_accordion",id:f,nonce:e},complete:function(a){f===parseInt(a.responseText,10)&&l.fadeOut(300,function(){l.remove()})}});d.remove()});d.find(".dialog-cancel").one("click",function(a){a.preventDefault();d.remove()});d.find(".modal-overlay").one("click",function(a){d.remove()})},duplicateAccordion:function(b){var c=a.lightURLParse(b.attr("href"));b=c.dua_nonce;
c=parseInt(c.id,10);a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_duplicate_accordion",id:c,nonce:b},complete:function(b){a(b.responseText).appendTo(a(".accordions-list tbody")).hide().fadeIn()}})},initPanels:function(){var b=this;a(".panels-container").find(".panel").each(function(c){b.initPanel(a(this))});a(".panels-container").lightSortable({children:".panel",placeholder:"panel panel-placeholder",sortEnd:function(b){a(".panel").each(function(b){a(this).attr("data-position",
b)})}})},initPanel:function(a,c){var b=this,f=new d(a,this.panelCounter,c);this.panels.push(f);f.on("duplicatePanel",function(a){b.duplicatePanel(a.panelData)});f.on("deletePanel",function(a){b.deletePanel(a.id)});a.attr("data-id",this.panelCounter);a.attr("data-position",this.panelCounter);this.panelCounter++},getPanel:function(b){var c;a.each(this.panels,function(a,f){if(f.id===b)return c=f,!1});return c},duplicatePanel:function(b){var c=this,e=a.extend(!0,{},b);a.ajax({url:as_js_vars.ajaxurl,type:"post",
data:{action:"accordion_slider_lite_add_panels",data:JSON.stringify([{settings:{content_type:e.settings.content_type},background_source:e.background.background_source}])},complete:function(b){b=a(b.responseText).appendTo(a(".panels-container"));c.initPanel(b,e)}})},deletePanel:function(b){var c=this,e=c.getPanel(b),f=a('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-panel-dialog">\t\t<p class="dialog-question">'+as_js_vars.panel_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+
as_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+as_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");a(".modal-window-container").css("top",a(window).scrollTop());f.find(".dialog-ok").one("click",function(b){b.preventDefault();e.off("duplicatePanel");e.off("deletePanel");e.remove();f.remove();c.panels.splice(a.inArray(e,c.panels),1)});f.find(".dialog-cancel").one("click",function(a){a.preventDefault();f.remove()});f.find(".modal-overlay").one("click",function(a){f.remove()})},
addImagePanels:function(){var b=this;h.open(function(c){var e=[];a.each(c,function(a,b){e.push({background_source:b.url,background_alt:b.alt,background_title:b.title,background_width:b.width,background_height:b.height,background_link:b.link})});a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_add_panels",data:JSON.stringify(e)},complete:function(c){var d=a(".panels-container").find(".panel").length-1;a(".panels-container").append(c.responseText).find(".panel"+(-1===d?
"":":gt("+d+")")).each(function(c){var d=a(this);b.initPanel(d,{background:e[c],layers:{},html:"",settings:{}})});k.checkBackgroundImageSize()}})})},showInfo:function(b){var c=b.attr("data-info"),e=null;"undefined"!==typeof c&&(e=a('<div class="info-tooltip">'+c+"</div>").appendTo(b.parent()),e.css({left:-e.outerWidth(!0),marginTop:.5*-e.outerHeight(!0)-9}));b.on("mouseout",function(){null!==e&&e.remove()})},resizePanelImages:function(){var b=a(".panel-preview").width()/a(".panel-preview").height();
a(".panel-preview > img").each(function(){var c=a(this);c.width()/c.height()>b?c.css({width:"auto",height:"100%"}):c.css({width:"100%",height:"auto"})})},checkBackgroundImageSize:function(){if(0!==a(".image-size-warning").length){var b=!1,c=a(".sidebar-settings").find('.setting[name="width"]').val(),e=a(".sidebar-settings").find('.setting[name="height"]').val(),d=a(".sidebar-settings").find('.setting[name="orientation"]').val();a.each(this.panels,function(a,f){var g=f.getData("background");0!==parseInt(g.background_width,
10)&&0!==parseInt(g.background_height,10)&&("vertical"===d&&!1===isNaN(c)&&parseInt(g.background_width,10)<parseInt(c,10)||"horizontal"===d&&!1===isNaN(e)&&parseInt(g.background_height,10)<parseInt(e,10))&&(b=!0)});!0===b?a(".image-size-warning").css("display","block"):a(".image-size-warning").css("display","")}}},d=function(b,c,e){this.$panel=b;this.id=c;this.data=e;this.events=a({});"undefined"===typeof this.data&&(this.data={background:{},layers:{},html:"",settings:{}});this.init()};d.prototype=
{init:function(){var a=this;this.$panel.find(".panel-preview").on("click",function(b){h.open(function(b){b=b[0];a.setData("background",{background_source:b.url,background_alt:b.alt,background_title:b.title,background_width:b.width,background_height:b.height,background_link:b.link});a.updatePanelPreview();k.checkBackgroundImageSize()})});this.$panel.find(".delete-panel").on("click",function(b){b.preventDefault();a.trigger({type:"deletePanel",id:a.id})});this.$panel.find(".duplicate-panel").on("click",
function(b){b.preventDefault();a.trigger({type:"duplicatePanel",panelData:a.data})});this.resizeImage()},getData:function(b){if("all"===b){var c={};a.each(this.data.background,function(a,b){c[a]=b});c.layers=this.data.layers;c.html=this.data.html;c.settings=this.data.settings;return c}if("background"===b)return this.data.background},setData:function(b,c){var d=this;"all"===b?this.data=c:"background"===b&&a.each(c,function(a,b){d.data.background[a]=b})},remove:function(){this.$panel.find(".panel-preview").off("click");
this.$panel.find(".delete-panel").off("click");this.$panel.find(".duplicate-panel").off("click");this.$panel.fadeOut(500,function(){a(this).remove()})},updatePanelPreview:function(){var b=this.$panel.find(".panel-preview"),c=this.data.settings.content_type;b.empty();if("undefined"===typeof c||"custom"===c)c=this.data.background.background_source,"undefined"!==typeof c&&""!==c?(a('<img src="'+c+'" />').appendTo(b),this.resizeImage()):a('<p class="no-image">'+as_js_vars.no_image+"</p>").appendTo(b),
this.$panel.removeClass("dynamic-panel")},resizeImage:function(){var a=this.$panel.find(".panel-preview"),c=this.$panel.find(".panel-preview > img");if(c.length)var d=setInterval(function(){!0===c[0].complete&&(clearInterval(d),c.width()/c.height()>a.width()/a.height()?c.css({width:"auto",height:"100%"}):c.css({width:"100%",height:"auto"}))},100)},on:function(a,c){this.events.on(a,c)},off:function(a){this.events.off(a)},trigger:function(a){this.events.triggerHandler(a)}};var h={open:function(a){var b=
[],d=wp.media.editor.insert;wp.media.editor.send.attachment=function(a,c){var d="undefined"!==typeof c.sizes[a.size]?c.sizes[a.size]:c.sizes.full;b.push({url:d.url,alt:c.alt,title:c.title,width:d.width,height:d.height,link:"custom"===a.link?a.linkUrl:""})};wp.media.editor.insert=function(c){a.call(this,b);wp.media.editor.insert=d};wp.media.editor.open("media-loader")}},g={previewWindow:null,accordion:null,accordionData:null,open:function(b){this.accordionData=b;var c=this,d=a(".preview-spinner").css({display:"inline-block",
visibility:"visible"});a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_preview_accordion",data:JSON.stringify(b)},complete:function(b){a("body").append(b.responseText);c.init();d.css({display:"",visibility:""})}})},init:function(){var b=this;a(".modal-window-container").css("top",a(window).scrollTop());this.previewWindow=a(".preview-window .modal-window");this.accordion=this.previewWindow.find(".accordion-slider");this.previewWindow.find(".close-x").on("click",function(a){b.close()});
var c=this.accordionData.settings.width,d=this.accordionData.settings.height,f=-1!==c.indexOf("%"),g=-1!==d.indexOf("%");!0===f?this.accordion.accordionSlider("width","100%"):c=parseInt(c,10);!0===g&&this.accordion.accordionSlider("height","100%");a(window).on("resize.accordionSlider",function(){!0===f?b.previewWindow.css("width",a(window).width()*(parseInt(c,10)/100)-100):c>=a(window).width()-100?b.previewWindow.css("width",a(window).width()-100):b.previewWindow.css("width",c);!0===g&&b.previewWindow.css("height",
a(window).height()*(parseInt(d,10)/100)-200)});a(window).trigger("resize");a(window).trigger("resize")},close:function(){this.previewWindow.find(".close-x").off("click");a(window).off("resize.accordionSlider");this.accordion.accordionSlider("destroy");a("body").find(".modal-overlay, .modal-window-container").remove()}};a(document).ready(function(){k.init()})})(jQuery);
(function(a){var k=function(d,h){this.options=h;this.$container=a(d);this.$placeholder=this.$selectedChild=null;this.initialMouseY=this.initialMouseX=this.panelInitialY=this.panelInitialX=this.currentMouseY=this.currentMouseX=0;this.isDragging=!1;this.checkHover=0;this.uid=(new Date).valueOf();this.events=a({});this.endPosition=this.startPosition=0;this.init()};k.prototype={init:function(){this.settings=a.extend({},this.defaults,this.options);this.$container.on("mousedown.lightSortable"+this.uid,
a.proxy(this._onDragStart,this));a(document).on("mousemove.lightSortable."+this.uid,a.proxy(this._onDragging,this));a(document).on("mouseup.lightSortable."+this.uid,a.proxy(this._onDragEnd,this))},_onDragStart:function(d){1!==d.which||a(d.target).is("select")||a(d.target).is("input")||(this.$selectedChild=a(d.target).is(this.settings.children)?a(d.target):a(d.target).parents(this.settings.children),1===this.$selectedChild.length&&(this.initialMouseX=d.pageX,this.initialMouseY=d.pageY,this.panelInitialX=
this.$selectedChild.position().left,this.panelInitialY=this.$selectedChild.position().top,this.startPosition=this.$selectedChild.index(),d.preventDefault()))},_onDragging:function(d){if(null!==this.$selectedChild&&0!==this.$selectedChild.length){d.preventDefault();this.currentMouseX=d.pageX;this.currentMouseY=d.pageY;if(!this.isDragging){this.isDragging=!0;this.trigger({type:"sortStart"});a.isFunction(this.settings.sortStart)&&this.settings.sortStart.call(this,{type:"sortStart"});d=this.$container.is("ul")||
this.$container.is("ol")?"li":"div";this.$placeholder=a("<"+d+">").addClass("ls-ignore "+this.settings.placeholder).insertAfter(this.$selectedChild);0===this.$placeholder.width()&&this.$placeholder.css("width",this.$selectedChild.outerWidth());0===this.$placeholder.height()&&this.$placeholder.css("height",this.$selectedChild.outerHeight());this.$selectedChild.css({"pointer-events":"none",position:"absolute",left:this.$selectedChild.position().left,top:this.$selectedChild.position().top,width:this.$selectedChild.width(),
height:this.$selectedChild.height()}).addClass("ls-ignore");this.$container.append(this.$selectedChild);a("body").css("user-select","none");var h=this;this.checkHover=setInterval(function(){h.$container.find(h.settings.children).not(".ls-ignore").each(function(){var d=a(this);h.currentMouseX>d.offset().left&&h.currentMouseX<d.offset().left+d.width()&&h.currentMouseY>d.offset().top&&h.currentMouseY<d.offset().top+d.height()&&(d.index()>=h.$placeholder.index()?h.$placeholder.insertAfter(d):h.$placeholder.insertBefore(d))})},
200)}this.$selectedChild.css({left:this.currentMouseX-this.initialMouseX+this.panelInitialX,top:this.currentMouseY-this.initialMouseY+this.panelInitialY})}},_onDragEnd:function(){this.isDragging&&(this.isDragging=!1,a("body").css("user-select",""),this.$selectedChild.css({position:"",left:"",top:"",width:"",height:"","pointer-events":""}).removeClass("ls-ignore").insertAfter(this.$placeholder),this.$placeholder.remove(),clearInterval(this.checkHover),this.endPosition=this.$selectedChild.index(),this.trigger({type:"sortEnd"}),
a.isFunction(this.settings.sortEnd)&&this.settings.sortEnd.call(this,{type:"sortEnd",startPosition:this.startPosition,endPosition:this.endPosition}));this.$selectedChild=null},destroy:function(){this.$container.removeData("lightSortable");this.isDragging&&this._onDragEnd();this.$container.off("mousedown.lightSortable."+this.uid);a(document).off("mousemove.lightSortable."+this.uid);a(document).off("mouseup.lightSortable."+this.uid)},on:function(a,h){return this.events.on(a,h)},off:function(a){return this.events.off(a)},
trigger:function(a){return this.events.triggerHandler(a)},defaults:{placeholder:"",sortStart:function(){},sortEnd:function(){}}};a.fn.lightSortable=function(d){var h=Array.prototype.slice.call(arguments,1);return this.each(function(){if("undefined"===typeof a(this).data("lightSortable")){var g=new k(this,d);a(this).data("lightSortable",g)}else"undefined"!==typeof d&&(g=a(this).data("lightSortable"),"function"===typeof g[d]?g[d].apply(g,h):a.error(d+" does not exist in lightSortable."))})}})(jQuery);
(function(a){a.lightURLParse=function(k){k=k.split("?")[1].split("&");var d=[];a.each(k,function(a,g){var b=g.split("=");d[b[0]]=b[1]});return d}})(jQuery);